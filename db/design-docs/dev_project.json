{"views":{"summary":{"map":"function (doc, meta) {\n  if(doc.type == 'project') {\n    var value = {name: doc.name, desc: doc.desc};\n    var administrators = doc.administrators ? doc.administrators : [];\n    var collaborators = doc.collaborators ? doc.collaborators : [];\n    var users = administrators.concat(collaborators);\n    if(users.length > 0) value.users = users;\n    emit(meta.id, value);\n  } else if(doc.type == 'task') {\n    var key = doc.project ? doc.project : 'none';\n    emit(key, {status: doc.status ? doc.status : 'open'});\n  }\n}","reduce":"function (keys, values, rereduce) {\n  var out = {\n    numOfTasks: 0,\n    status: {}\n  };\n  for(var i = 0; i < values.length; i++) {\n    var v = values[i];\n    if(v.status) {\n      out.numOfTasks++;\n      var s = v.status;\n      var numOfStatus = out.status[s] ? out.status[s] : 0;\n      out.status[s] = ++numOfStatus;\n    } else {\n      out.name = v.name;\n      out.desc = v.desc;\n      out.users = v.users;\n    }\n  }\n  return out;\n}"}}}